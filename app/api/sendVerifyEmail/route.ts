import { NextResponse } from "next/server"
import nodemailer from "nodemailer"

export const POST = async () => {
  try {
    const transport = nodemailer.createTransport({
      host: process.env.EMAIL_SERVER_HOST as string,
      port: process.env.EMAIL_SERVER_PORT as unknown as number,
      auth: {
        user: process.env.EMAIL_SERVER_USER as string,
        pass: process.env.EMAIL_SERVER_PASSWORD as string,
      },
    })
    const token = "123456789"
    const href = `${process.env.NEXTAUTH_URL}/verify-account?token=${token}`

    const mailOptions = {
      from: process.env.EMAIL_FROM as string,
      to: "filwyd123@gmail.com",
      subject: "Verify Email",
      html: `
      <div style="width: 100%; height:100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: white; "Gill Sans", sans-serif">
      <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; word-wrap:wrap; max-width: 100vw; padding:32px 24px; margin: 32px 16px; background:#f7f5ff; border-radius: 16px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)">
    <h1 style="text-align: center;">
    <svg xmlns="http://www.w3.org/2000/svg" width="215" height="22" viewBox="0 0 350 35.52370148976368" class="css-1j8o68f"><g id="SvgjsG2273" featurekey="nameFeature-0" transform="matrix(1.2686220460247157,0,0,1.2686220460247157,-2.029904644284077,-15.222448276396072)" fill="#000000"><path d="M5.3492 20.906 l8.2628 8.2628 c0.62808 0.62808 0.81584 1.5726 0.476 2.3932 s-1.1406 1.3555 -2.0289 1.3555 l-6.0666 0 l0 4.8862 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 l0 -7.0824 c0 -1.2128 0.98328 -2.196 2.196 -2.196 l2.9611 0 l-4.5136 -4.5136 c-0.85784 -0.85756 -0.85784 -2.248 0 -3.1056 c0.85756 -0.85756 2.248 -0.85756 3.1056 0 z M21.502 12 c1.213 0 2.1963 0.98328 2.1963 2.196 s-0.98328 2.196 -2.196 2.196 l-12.404 0 l4.5136 4.5136 c0.85784 0.85756 0.85784 2.248 0 3.1056 c-0.4288 0.4288 -0.99072 0.64316 -1.5529 0.64316 s-1.1241 -0.21438 -1.5529 -0.64316 l-8.2628 -8.2628 c-0.62808 -0.62808 -0.81584 -1.5726 -0.476 -2.3932 s1.1406 -1.3555 2.0289 -1.3555 l17.706 0 z M29.948 19.412 c1.2128 0 2.196 0.98328 2.196 2.196 s-0.98328 2.196 -2.196 2.196 c-3.2543 0 -5.902 2.6476 -5.902 5.902 l0 8.098 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 l0 -16.196 c0 -1.2128 0.98328 -2.196 2.196 -2.196 c1.1071 0 2.0201 0.81996 2.1716 1.885 c1.677 -1.1856 3.721 -1.885 5.9264 -1.885 z M36.264 19.412 c1.2128 0 2.196 0.98328 2.196 2.196 l0 16.196 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 l0 -16.196 c0 -1.2128 0.98328 -2.196 2.196 -2.196 z M34.235400000000006 15.036000000000001 c-0.054884 -0.13176 -0.096056 -0.2718 -0.12352 -0.4118 c-0.030195 -0.14 -0.043908 -0.28551 -0.043908 -0.42824 s0.013711 -0.28824 0.043908 -0.42824 c0.027461 -0.14 0.068632 -0.28 0.12352 -0.41176 s0.12352 -0.26078 0.20312 -0.37883 c0.079608 -0.12078 0.1702 -0.23332 0.27176 -0.33488 s0.2141 -0.19215 0.33488 -0.27176 c0.11805 -0.079608 0.24707 -0.14824 0.37883 -0.20312 s0.27176 -0.096056 0.41176 -0.12352 c0.71372 -0.14551 1.4714 0.090588 1.982 0.59844 c0.098828 0.10156 0.19215 0.2141 0.27176 0.33488 c0.079608 0.11805 0.14824 0.24707 0.20312 0.37883 s0.096056 0.27176 0.12352 0.41176 c0.030195 0.14 0.043908 0.28551 0.043908 0.42824 s-0.013711 0.28824 -0.043908 0.42824 c-0.027461 0.14 -0.068632 0.28 -0.12352 0.41176 s-0.12352 0.26078 -0.20312 0.37883 c-0.079608 0.12078 -0.17293 0.23332 -0.27176 0.33488 c-0.10156 0.10156 -0.2141 0.19215 -0.33488 0.27176 c-0.11805 0.079608 -0.24707 0.14824 -0.37883 0.20312 s-0.27176 0.096056 -0.41176 0.12352 c-0.14 0.030195 -0.28551 0.043908 -0.42824 0.043908 s-0.28824 -0.013711 -0.42824 -0.043908 c-0.14 -0.027461 -0.28 -0.068632 -0.41176 -0.12352 s-0.26078 -0.12352 -0.37883 -0.20312 c-0.12078 -0.079608 -0.23332 -0.1702 -0.33488 -0.27176 s-0.19215 -0.2141 -0.27176 -0.33488 c-0.079608 -0.11805 -0.14824 -0.24707 -0.20312 -0.37883 z M50.736000000000004 19.412 c5.6764 0 10.294 4.6176 10.294 10.294 c0 1.2128 -0.98328 2.196 -2.196 2.196 l-13.576 0 c0.87292 2.17 2.9995 3.7059 5.4784 3.7059 c1.5765 0 3.0586 -0.6138 4.1732 -1.7286 c0.85784 -0.85756 2.248 -0.85732 3.1058 0 c0.85784 0.85784 0.85756 2.2482 0 3.1058 c-1.9446 1.9443 -4.5296 3.0149 -7.2792 3.0149 c-5.6764 0 -10.294 -4.6176 -10.294 -10.294 s4.6176 -10.294 10.294 -10.294 z M45.257600000000004 27.509999999999998 l10.957 0 c-0.87292 -2.17 -2.9995 -3.7059 -5.4784 -3.7059 s-4.6056 1.5359 -5.4784 3.7059 z M70.9564 19.412 c4.4004 0 7.98 3.5802 7.98 7.9804 l0 10.412 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 l0 -10.412 c0 -1.9784 -1.6094 -3.5881 -3.5881 -3.5881 s-3.5881 1.6094 -3.5881 3.5881 l0 10.412 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 l0 -16.196 c0 -1.2128 0.98328 -2.196 2.196 -2.196 c0.78592 0 1.4733 0.4142 1.8615 1.0349 c1.1592 -0.65744 2.4975 -1.0349 3.9227 -1.0349 z M99.247 12 c1.2128 0 2.1961 0.98328 2.1961 2.196 l0 23.608 c0 1.2128 -0.98328 2.196 -2.196 2.196 c-1.103 0 -2.013 -0.81364 -2.1697 -1.873 c-1.6707 1.1782 -3.7056 1.873 -5.9008 1.873 c-5.6612 0 -10.267 -4.6056 -10.267 -10.267 s4.6056 -10.267 10.267 -10.267 c2.1837 0 4.2088 0.6874 5.8744 1.8541 l0 -7.1249 c0 -1.2128 0.98328 -2.196 2.196 -2.196 z M91.177 35.608 c3.2392 0 5.8744 -2.6353 5.8744 -5.8744 s-2.6353 -5.8744 -5.8744 -5.8744 s-5.8744 2.6353 -5.8744 5.8744 s2.6353 5.8744 5.8744 5.8744 z M104.0074 31.0944 c-0.85756 -0.85756 -0.8576 -2.2482 -0.0003125 -3.1055 l11.596 -11.596 l-10.043 0 c-1.2128 0 -2.196 -0.98328 -2.196 -2.196 s0.98328 -2.196 2.196 -2.196 l15.345 0 c0.88832 0 1.6888 0.535 2.0289 1.3555 s0.15234 1.7651 -0.47576 2.3932 l-15.345 15.345 c-0.4288 0.4288 -0.99096 0.64316 -1.5529 0.64316 c-0.5622 0 -1.1241 -0.21438 -1.5529 -0.64316 z M120.905 35.6084 c1.2128 0 2.1963 0.98324 2.1963 2.196 s-0.98328 2.196 -2.196 2.196 l-15.345 0 c-0.88832 0 -1.6888 -0.535 -2.0289 -1.3555 s-0.15234 -1.7651 0.47576 -2.3932 l15.345 -15.345 c0.85812 -0.85784 2.2482 -0.85756 3.1058 0 s0.85756 2.248 0 3.1056 l-11.596 11.596 l10.043 0 z M135.312 19.412 c5.6764 0 10.294 4.6176 10.294 10.294 s-4.6176 10.294 -10.294 10.294 s-10.294 -4.6176 -10.294 -10.294 s4.6176 -10.294 10.294 -10.294 z M135.312 35.608 c3.2543 0 5.902 -2.6476 5.902 -5.902 s-2.6476 -5.902 -5.902 -5.902 s-5.902 2.6476 -5.902 5.902 s2.6476 5.902 5.902 5.902 z M155.5324 19.412 c4.4004 0 7.98 3.5802 7.98 7.9804 l0 10.412 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 l0 -10.412 c0 -1.9784 -1.6094 -3.5881 -3.5881 -3.5881 s-3.5881 1.6094 -3.5881 3.5881 l0 10.412 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 l0 -16.196 c0 -1.2128 0.98328 -2.196 2.196 -2.196 c0.78592 0 1.4733 0.4142 1.8615 1.0349 c1.1592 -0.65744 2.4975 -1.0349 3.9227 -1.0349 z M175.78 19.412 c5.6764 0 10.294 4.6176 10.294 10.294 c0 1.2128 -0.98328 2.196 -2.196 2.196 l-13.576 0 c0.87292 2.17 2.9995 3.7059 5.4784 3.7059 c1.5765 0 3.0586 -0.6138 4.1732 -1.7286 c0.85784 -0.85756 2.248 -0.85732 3.1058 0 c0.85784 0.85784 0.85756 2.2482 0 3.1058 c-1.9446 1.9443 -4.5296 3.0149 -7.2792 3.0149 c-5.6764 0 -10.294 -4.6176 -10.294 -10.294 s4.6176 -10.294 10.294 -10.294 z M170.3016 27.509999999999998 l10.957 0 c-0.87292 -2.17 -2.9995 -3.7059 -5.4784 -3.7059 s-4.6056 1.5359 -5.4784 3.7059 z M217.676 27.345 c1.213 0 2.196 0.98328 2.196 2.196 c0 5.7668 -4.692 10.459 -10.459 10.459 s-10.459 -4.692 -10.459 -10.459 l0 -7.0824 c0 -5.7668 4.692 -10.459 10.459 -10.459 s10.459 4.692 10.459 10.459 c0 1.2128 -0.98328 2.196 -2.196 2.196 s-2.196 -0.98328 -2.196 -2.196 c0 -3.3452 -2.7215 -6.0668 -6.0668 -6.0668 s-6.0668 2.7215 -6.0668 6.0668 l0 7.0824 c0 3.3452 2.7215 6.0668 6.0668 6.0668 s6.0668 -2.7215 6.0668 -6.0668 c0 -1.2128 0.98328 -2.196 2.196 -2.196 z M232.26699999999997 35.608 c1.2128 0 2.1961 0.98332 2.1961 2.1961 s-0.98328 2.196 -2.196 2.196 c-5.7668 0 -10.459 -4.692 -10.459 -10.459 l0 -15.345 c0 -1.2128 0.98328 -2.196 2.196 -2.196 s2.196 0.98328 2.196 2.196 l0 15.345 c0 3.3452 2.7215 6.0668 6.0668 6.0668 z M252.81399999999996 19.412 c1.2128 0 2.196 0.98328 2.196 2.196 l0 8.098 c0 5.6764 -4.6176 10.294 -10.294 10.294 s-10.294 -4.6176 -10.294 -10.294 l0 -8.098 c0 -1.2128 0.98328 -2.196 2.196 -2.196 s2.196 0.98328 2.196 2.196 l0 8.098 c0 3.2543 2.6476 5.902 5.902 5.902 s5.902 -2.6476 5.902 -5.902 l0 -8.098 c0 -1.2128 0.98328 -2.196 2.196 -2.196 z M267.22299999999996 19.467 c5.6612 0 10.267 4.6056 10.267 10.267 s-4.6056 10.267 -10.267 10.267 c-2.1952 0 -4.23 -0.69476 -5.9008 -1.873 c-0.15676 1.0593 -1.067 1.873 -2.1697 1.873 c-1.2128 0 -2.196 -0.98328 -2.196 -2.196 l0 -23.608 c0 -1.2128 0.98328 -2.196 2.196 -2.196 s2.196 0.98328 2.196 2.196 l0 7.1246 c1.6657 -1.1667 3.6908 -1.8541 5.8744 -1.8541 z M267.22299999999996 35.608 c3.2392 0 5.8744 -2.6353 5.8744 -5.8744 s-2.6353 -5.8744 -5.8744 -5.8744 s-5.8744 2.6353 -5.8744 5.8744 s2.6353 5.8744 5.8744 5.8744 z"></path></g></svg>
    </h1>
    <h4 style="text-align: center; margin-bottom: 2.5rem">Please verify your email to secure your account</h4>
    <a href=${href}> <button style="padding: 10px 30px; font-size: 20px; color: white; background: #c81979; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)">Verify Now</button> </a>
    <p style="text-align: center; margin-top: 2.5rem">If the button doesn't work, paste this link into your browser:</p>
    <a href=${href} style="text-align: center; color: #c81979">${href}</a>
    <p><strong>&nbsp;</strong></p>
    <p style="text-align: center; font-size: 0.8rem; margin: 2px 0px;">This link will expire in 12 hours</p>
    <p style="text-align: center;font-size: 0.8rem;">If you did not request this email, you can safely ignore it.</p>
          </div>
    </div>
      `,
    }

    const response = await transport.sendMail(mailOptions)

    if (response.accepted.length === 0) {
      return NextResponse.json({ error: "Email not sent" }, { status: 500 })
    }

    return NextResponse.json({ message: "Email sent" }, { status: 200 })
  } catch (error) {
    return NextResponse.json({ error })
  }
}
